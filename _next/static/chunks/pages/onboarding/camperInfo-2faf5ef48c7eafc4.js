(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[516],{2961:(e,a,r)=>{var t={"./ca/common.json":[8517,517],"./en/common.json":[1871,252],"./es/common.json":[7433,814],"./fr/common.json":[2285,285],"./it/common.json":[8014,14]};function n(e){if(!r.o(t,e))return Promise.resolve().then(()=>{var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a});var a=t[e],n=a[0];return r.e(a[1]).then(()=>r.t(n,19))}n.keys=()=>Object.keys(t),n.id=2961,e.exports=n},6101:(e,a,r)=>{"use strict";r.d(a,{A:()=>n});var t=r(7876);r(4232),r(8230),r(9099);let n=e=>{let{children:a}=e;return(0,t.jsx)("div",{className:"flex flex-col min-h-screen",children:(0,t.jsx)("main",{className:"flex-grow pt-16",children:a})})}},7105:(e,a,r)=>{"use strict";r.r(a),r.d(a,{__N_SSG:()=>h,default:()=>x});var t=r(7876),n=r(2002),s=r(7328),o=r.n(s),l=r(4232),i=r(9611),c=r(6101),d=r(6879);let m="https://ektalbtnirqlttfkxdhe.supabase.co",u="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVrdGFsYnRuaXJxbHR0Zmt4ZGhlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI1Nzg0MDMsImV4cCI6MjA1ODE1NDQwM30.rAnmyyn7W9VHmb8f0LOEQ6LesoqpaFZjT034IyHkBes";m&&u||console.error("Відсутні Supabase URL або ключ! Перевірте налаштування середовища."),console.log("Supabase URL:",m);let p=(0,d.UU)(m,u);var g=r(9099),h=!0;function x(){let{t:e}=(0,n.Bd)("common"),a=(0,g.useRouter)(),[r,s]=(0,l.useState)({companyName:"",registrationNumber:"",contactPersonName:"",email:"",phone:"",address:"",delegationModel:"",agreeToModernize:!1}),[d,m]=(0,l.useState)({camperMake:"",camperModel:"",camperYear:"",camperPlate:""}),[u,h]=(0,l.useState)(!1),[x,f]=(0,l.useState)(null),[b,y]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=localStorage.getItem("companyRegistrationData");if(e)try{let a=JSON.parse(e);s(a)}catch(e){console.error("Error parsing saved company data:",e),a.push("/onboarding/companyInfo")}else a.push("/onboarding/companyInfo")},[a]);let j=e=>{let{name:a,value:r}=e.target;m({...d,[a]:r})},w=async e=>{e.preventDefault(),f(null),y(null),h(!0);try{let{data:e,error:t}=await p.from("users").insert([{email:r.email,name:r.contactPersonName,role:"company",phone:r.phone,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select("id").single();if(t)throw Error(`Error saving company data: ${t.message}`);let n=e.id;console.log("Company successfully registered with ID:",n);let{data:s,error:o}=await p.from("vehicles").insert([{owner_id:n,make:d.camperMake,model:d.camperModel,year:parseInt(d.camperYear)||new Date().getFullYear(),plate:d.camperPlate,delegation_model:r.delegationModel.replace("-","_"),modernize_agreed:r.agreeToModernize,status:"draft",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select("id").single();if(o)throw Error(`Error saving vehicle data: ${o.message}`);console.log("Vehicle successfully registered with ID:",s.id);let{data:l,error:i}=await p.from("agreements").insert([{user_id:n,agreement_type:`company_${r.delegationModel}`,signature_status:"pending",created_at:new Date().toISOString()}]).select("id");i&&console.warn("Warning: failed to create agreement:",i),y("Data successfully saved! Redirecting to the next step..."),localStorage.removeItem("companyRegistrationData"),setTimeout(()=>{a.push("/onboarding/success")},2e3)}catch(e){console.error("Error processing form:",e),f(e instanceof Error?e.message:"An unknown error occurred while saving data")}finally{h(!1)}};return(0,t.jsxs)(c.A,{children:[(0,t.jsxs)(o(),{children:[(0,t.jsx)("title",{children:"Camper Information | MrVan"}),(0,t.jsx)("meta",{name:"description",content:"Register your camper fleet with MrVan"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsx)("section",{className:"py-20",children:(0,t.jsx)("div",{className:"container-custom",children:(0,t.jsx)("div",{className:"max-w-2xl mx-auto bg-white rounded-xl shadow-md overflow-hidden",children:(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-center text-gray-900 mb-6",children:"\uD83D\uDE90 Camper Registration"}),(0,t.jsx)("p",{className:"text-gray-600 mb-8 text-center",children:"Register your camper fleet with MrVan."}),x&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4",children:x}),b&&(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md mb-4",children:b}),(0,t.jsxs)("form",{onSubmit:w,children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-indigo-600 mt-6 mb-4",children:"Camper Information"}),(0,t.jsx)(i.A,{id:"camperMake",name:"camperMake",label:"Camper Make",value:d.camperMake,onChange:j,required:!0}),(0,t.jsx)(i.A,{id:"camperModel",name:"camperModel",label:"Camper Model",value:d.camperModel,onChange:j,required:!0}),(0,t.jsx)(i.A,{id:"camperYear",name:"camperYear",type:"number",label:"Year of Manufacture",value:d.camperYear,onChange:j,required:!0}),(0,t.jsx)(i.A,{id:"camperPlate",name:"camperPlate",label:"License Plate",value:d.camperPlate,onChange:j,required:!0})]}),(0,t.jsxs)("div",{className:"mt-8 flex items-center justify-between",children:[(0,t.jsx)("button",{type:"button",onClick:()=>a.push("/onboarding/companyInfo"),className:"btn-secondary",disabled:u,children:"Back to Company Info"}),(0,t.jsx)("button",{type:"submit",className:"btn-primary",disabled:u,children:u?"Saving...":"Complete Registration"})]})]})]})})})})]})}},9424:(e,a,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/onboarding/camperInfo",function(){return r(7105)}])},9611:(e,a,r)=>{"use strict";r.d(a,{A:()=>n});var t=r(7876);function n(e){let{id:a,name:r,label:n,value:s,onChange:o,type:l="text",placeholder:i,required:c=!1}=e;return(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("label",{htmlFor:a,className:"block text-sm font-medium text-gray-700 mb-1",children:[n," ",c&&(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{id:a,name:r,type:l,value:s,onChange:o,placeholder:i,required:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-cyan-600 focus:border-cyan-600"})]})}r(4232)}},e=>{var a=a=>e(e.s=a);e.O(0,[695,260,636,593,792],()=>a(9424)),_N_E=e.O()}]);