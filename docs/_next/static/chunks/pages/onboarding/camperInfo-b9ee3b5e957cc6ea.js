(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[210],{8452:function(e,r,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/onboarding/camperInfo",function(){return a(2023)}])},1771:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});var n=a(5893);function t(e){let{id:r,name:a,label:t,value:o,onChange:s,type:i="text",placeholder:c,required:l=!1}=e;return(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsxs)("label",{htmlFor:r,className:"block text-sm font-medium text-gray-700 mb-1",children:[t," ",l&&(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)("input",{id:r,name:a,type:i,value:o,onChange:s,placeholder:c,required:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-cyan-600 focus:border-cyan-600"})]})}a(7294)},4820:function(e,r,a){"use strict";var n=a(5893);a(7294),a(1664),a(1163),r.Z=e=>{let{children:r}=e;return(0,n.jsx)("div",{className:"flex flex-col min-h-screen",children:(0,n.jsx)("main",{className:"flex-grow pt-16",children:r})})}},2023:function(e,r,a){"use strict";a.r(r),a.d(r,{__N_SSG:function(){return f},default:function(){return h}});var n=a(5893),t=a(8276),o=a(9008),s=a.n(o),i=a(7294),c=a(1771),l=a(4820),d=a(8967);let m="https://ektalbtnirqlttfkxdhe.supabase.co",u="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVrdGFsYnRuaXJxbHR0Zmt4ZGhlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI1Nzg0MDMsImV4cCI6MjA1ODE1NDQwM30.rAnmyyn7W9VHmb8f0LOEQ6LesoqpaFZjT034IyHkBes";m&&u||console.error("Відсутні Supabase URL або ключ! Перевірте налаштування середовища."),console.log("Supabase URL:",m);let p=(0,d.eI)(m,u);var g=a(1163),f=!0;function h(){let{t:e}=(0,t.$G)("common"),r=(0,g.useRouter)(),[a,o]=(0,i.useState)({companyName:"",registrationNumber:"",contactPersonName:"",email:"",phone:"",address:"",delegationModel:"",agreeToModernize:!1}),[d,m]=(0,i.useState)({camperMake:"",camperModel:"",camperYear:"",camperPlate:""}),[u,f]=(0,i.useState)(!1),[h,x]=(0,i.useState)(null),[b,y]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=localStorage.getItem("companyRegistrationData");if(e)try{let r=JSON.parse(e);o(r)}catch(e){console.error("Error parsing saved company data:",e),r.push("/onboarding/companyInfo")}else r.push("/onboarding/companyInfo")},[r]);let j=e=>{let{name:r,value:a}=e.target;m({...d,[r]:a})},w=async e=>{e.preventDefault(),x(null),y(null),f(!0);try{let{data:e,error:n}=await p.from("users").insert([{email:a.email,name:a.contactPersonName,role:"company",phone:a.phone,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select("id").single();if(n)throw Error(`Error saving company data: ${n.message}`);let t=e.id;console.log("Company successfully registered with ID:",t);let{data:o,error:s}=await p.from("vehicles").insert([{owner_id:t,make:d.camperMake,model:d.camperModel,year:parseInt(d.camperYear)||new Date().getFullYear(),plate:d.camperPlate,delegation_model:a.delegationModel.replace("-","_"),modernize_agreed:a.agreeToModernize,status:"draft",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select("id").single();if(s)throw Error(`Error saving vehicle data: ${s.message}`);console.log("Vehicle successfully registered with ID:",o.id);let{data:i,error:c}=await p.from("agreements").insert([{user_id:t,agreement_type:`company_${a.delegationModel}`,signature_status:"pending",created_at:new Date().toISOString()}]).select("id");c&&console.warn("Warning: failed to create agreement:",c),y("Data successfully saved! Redirecting to the next step..."),localStorage.removeItem("companyRegistrationData"),setTimeout(()=>{r.push("/onboarding/success")},2e3)}catch(e){console.error("Error processing form:",e),x(e instanceof Error?e.message:"An unknown error occurred while saving data")}finally{f(!1)}};return(0,n.jsxs)(l.Z,{children:[(0,n.jsxs)(s(),{children:[(0,n.jsx)("title",{children:"Camper Information | MrVan"}),(0,n.jsx)("meta",{name:"description",content:"Register your camper fleet with MrVan"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)("section",{className:"py-20",children:(0,n.jsx)("div",{className:"container-custom",children:(0,n.jsx)("div",{className:"max-w-2xl mx-auto bg-white rounded-xl shadow-md overflow-hidden",children:(0,n.jsxs)("div",{className:"p-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-center text-gray-900 mb-6",children:"\uD83D\uDE90 Camper Registration"}),(0,n.jsx)("p",{className:"text-gray-600 mb-8 text-center",children:"Register your camper fleet with MrVan."}),h&&(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4",children:h}),b&&(0,n.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md mb-4",children:b}),(0,n.jsxs)("form",{onSubmit:w,children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-indigo-600 mt-6 mb-4",children:"Camper Information"}),(0,n.jsx)(c.Z,{id:"camperMake",name:"camperMake",label:"Camper Make",value:d.camperMake,onChange:j,required:!0}),(0,n.jsx)(c.Z,{id:"camperModel",name:"camperModel",label:"Camper Model",value:d.camperModel,onChange:j,required:!0}),(0,n.jsx)(c.Z,{id:"camperYear",name:"camperYear",type:"number",label:"Year of Manufacture",value:d.camperYear,onChange:j,required:!0}),(0,n.jsx)(c.Z,{id:"camperPlate",name:"camperPlate",label:"License Plate",value:d.camperPlate,onChange:j,required:!0})]}),(0,n.jsxs)("div",{className:"mt-8 flex items-center justify-between",children:[(0,n.jsx)("button",{type:"button",onClick:()=>r.push("/onboarding/companyInfo"),className:"btn-secondary",disabled:u,children:"Back to Company Info"}),(0,n.jsx)("button",{type:"submit",className:"btn-primary",disabled:u,children:u?"Saving...":"Complete Registration"})]})]})]})})})})]})}},6507:function(e,r,a){var n={"./ca/common.json":[3130,130],"./en/common.json":[3172,172],"./es/common.json":[3078,78],"./fr/common.json":[6210,160],"./it/common.json":[8085,85]};function t(e){if(!a.o(n,e))return Promise.resolve().then(function(){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r});var r=n[e],t=r[0];return a.e(r[1]).then(function(){return a.t(t,19)})}t.keys=function(){return Object.keys(n)},t.id=6507,e.exports=t}},function(e){e.O(0,[996,276,967,888,774,179],function(){return e(e.s=8452)}),_N_E=e.O()}]);